<button popovertarget="theme-popover" id="theme-button">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun-moon-icon lucide-sun-moon"><path d="M12 2v2"/><path d="M14.837 16.385a6 6 0 1 1-7.223-7.222c.624-.147.97.66.715 1.248a4 4 0 0 0 5.26 5.259c.589-.255 1.396.09 1.248.715"/><path d="M16 12a4 4 0 0 0-4-4"/><path d="m19 5-1.256 1.256"/><path d="M20 12h2"/></svg>
</button>

<div popover id='theme-popover'>
    <div class="flex flex-col p-4">

    <button id="theme-light" popovertarget="theme-popover" popovertargetaction="hide">Light</button>
    <button id="theme-dark" popovertarget="theme-popover" popovertargetaction="hide">Dark</button>
    <button id="theme-auto" popovertarget="theme-popover" popovertargetaction="hide">Auto</button>
    </div>
</div>

<script is:inline>
    const lightButton = document.querySelector('#theme-light');
    const darkButton = document.querySelector('#theme-dark');
    const autoButton = document.querySelector('#theme-auto');

    lightButton.addEventListener('click', () => {
        document.documentElement.setAttribute('data-theme', 'light');
    });

    darkButton.addEventListener('click', () => {
        document.documentElement.setAttribute('data-theme', 'dark');
    });

    autoButton.addEventListener('click', () => {
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
    });
</script>

<style>
    button {
        cursor: pointer;
    }

    #theme-button {
        anchor-name: --theme-button;
        /*position: fixed;*/
        /*padding: 1rem;*/
        /*top: 0;*/
        /*right: 0;*/
        grid-area: theme;
        align-self: start;
    }

    #theme-popover {
        position: fixed;
        position-anchor: --theme-button;
        position-area: bottom;
        /*top: -1rem;*/

        background: var(--background-color);
        color: var(--text-color);

    }
</style>
